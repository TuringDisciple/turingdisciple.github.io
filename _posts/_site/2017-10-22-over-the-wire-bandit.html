<p>This is my first experience with wargames. I’ll be going into to some detail of my answers but I am assuming anyone reading is fairly familiar with Linux and the terminal.</p>

<h3 id="level-0---level-1-and-level-1---level-2">Level 0 -&gt; Level 1 and Level 1 -&gt; Level 2</h3>
<p>Login into bandit 0, then just cat the readme.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">bandit0@bandit:~<span class="nv">$ </span>ssh bandit1@bandit.labs.overthewire.org <span class="nt">-p</span> 2220
bandit1@bandit:~<span class="nv">$ </span><span class="nb">cat</span> ./-</code></pre></figure>

<h3 id="level-2---level-3">Level 2 -&gt; Level 3</h3>
<p>The filename with the password has spaces making things a little bit more difficult</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">bandit2@bandit:~<span class="nv">$ </span><span class="nb">ls
</span>spaces <span class="k">in </span>this filename
bandit2@bandit:~<span class="nv">$ </span><span class="nb">cat </span>spaces%in%this%filename</code></pre></figure>

<h3 id="level-3---level-4">Level 3 -&gt; Level 4</h3>
<p>The password is stored in a hidden file.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">bandit3@bandit:~/inhere<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-a</span>
bandit3@bandit:~/inhere<span class="nv">$ </span><span class="nb">cat</span> .hidden
 </code></pre></figure>

<h3 id="level-4---level-5">Level 4 -&gt; Level 5</h3>
<p>Introducing, the file command!</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">bandit4@bandit:~<span class="nv">$ </span><span class="nb">ls 
</span>inhere
bandit4@bandit:~<span class="nv">$ </span><span class="nb">cd    
</span>bandit4@bandit:~<span class="nv">$ </span><span class="nb">cd </span>inhere/
bandit4@bandit:~/inhere<span class="nv">$ </span><span class="nb">ls</span>
<span class="nt">-file00</span>  <span class="nt">-file01</span>  <span class="nt">-file02</span>  <span class="nt">-file03</span>  <span class="nt">-file04</span>  <span class="nt">-file05</span>  <span class="nt">-file06</span>  <span class="nt">-file07</span>  <span class="nt">-file08</span>  <span class="nt">-file09</span>
bandit4@bandit:~/inhere<span class="nv">$ </span>file ./-<span class="k">*</span>
./-file00: Non-ISO extended-ASCII text, with CR line terminators, with escape sequences
./-file01: data
./-file02: data
./-file03: data
./-file04: data
./-file05: data
./-file06: data
./-file07: ASCII text
./-file08: data
./-file09: data
bandit4@bandit:~/inhere<span class="nv">$ </span><span class="nb">cat</span> ./-file07</code></pre></figure>

<h3 id="level-5---level-6">Level 5 -&gt; Level 6</h3>
<p>Introducing the find command!</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">bandit5@bandit:~<span class="nv">$ </span><span class="nb">cd </span>inhere/
bandit5@bandit:~/inhere<span class="nv">$ </span><span class="nb">cat</span> <span class="sb">`</span>find ./ <span class="nt">-size</span> 1033c<span class="sb">`</span></code></pre></figure>

<h3 id="level-6---level-7">Level 6 -&gt; Level 7</h3>
<p>Bit more fiddly.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">bandit6@bandit:~<span class="nv">$ </span>find / <span class="nt">-user</span> bandit7 <span class="nt">-group</span> bandit6 <span class="nt">-size</span> 33c 2&gt;/dev/null
/var/lib/dpkg/info/bandit7.password
bandit6@bandit:~<span class="nv">$ </span><span class="nb">cat</span> /var/lib/dpkg/info/bandit7.password </code></pre></figure>

<h3 id="level-7---level-8">Level 7 -&gt; Level 8</h3>
<p>This is a simple grep request</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">bandit7@bandit:~<span class="nv">$ </span><span class="nb">ls
</span>data.txt
bandit7@bandit:~<span class="nv">$ </span><span class="nb">cat </span>data.txt | <span class="nb">grep </span>millionth
millionth	x</code></pre></figure>

<h3 id="level-8---level-9">Level 8 -&gt; Level 9</h3>
<p>We can sort lines by occurence as follows</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">bandit8@bandit:~<span class="nv">$ </span><span class="nb">cat </span>data.txt | <span class="nb">sort</span> | <span class="nb">uniq</span> <span class="nt">-u</span></code></pre></figure>

<h3 id="level-9---level-10">Level 9 -&gt; Level 10</h3>
<p>Similar to 7, but we use strings to obtain all readable input characters</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">bandit9@bandit:~<span class="nv">$ </span>strings data.txt | <span class="nb">grep</span> <span class="s1">'='</span>
|<span class="o">==========</span> the
,]<span class="o">=</span>NB
@k&lt;<span class="o">=</span>
<span class="s2">"m=g	
========== password
=r-3
========== is
mu=v.
&lt;= V57
i=Hk&gt;</span><span class="nv">$B</span><span class="s2">
========== xxxxxxxxxxxxxxxxxxx
S1N=
PbgQ=Zp
=M Q
x3X}=</span></code></pre></figure>

<h4 id="level-10---level-11">Level 10 -&gt; Level 11</h4>
<p>The base64 command has a decode option</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">bandit10@bandit:~<span class="nv">$ </span><span class="nb">ls
</span>data.txt
bandit10@bandit:~<span class="nv">$ </span><span class="nb">base64</span> <span class="nt">-d</span> data.txt 
The password is xxxxxxxxxxxxxxxxxxxx</code></pre></figure>

<h3 id="level-11---level-12">Level 11 -&gt; Level 12</h3>
<p>We can use the tr command here</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">bandit11@bandit:~<span class="nv">$ </span><span class="nb">ls
</span>data.txt
bandit11@bandit:~<span class="nv">$ </span><span class="nb">cat </span>data.txt | <span class="nb">tr </span>a-zA-Z n-za-mN-ZA-M
The password is xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</code></pre></figure>

<h3 id="level-12---level-13">Level 12 -&gt; Level 13</h3>
<p>Worst! Level! Ever!</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">bandit12@bandit:~<span class="nv">$ </span>file data.txt 
data.txt: ASCII text
bandit12@bandit:~<span class="nv">$ </span>xxd <span class="nt">-r</span> data.txt <span class="o">&gt;</span> data1 
bandit12@bandit:~<span class="nv">$ </span>file data1        
data1: <span class="nb">gzip </span>compressed data, was <span class="s2">"data2.bin"</span>, from Unix, last modified: Thu Sep 28 14:04:06 2017, max compression
bandit12@bandit:~<span class="nv">$ </span>bzip2 <span class="nt">-d</span> data1
bzip2: Can<span class="s1">'t guess original name for data1 -- using data1.out
bzip2: data1 is not a bzip2 file.
bandit12@bandit:~$ zcat data1 &gt; dataNew
bandit12@bandit:~$ file dataNew 
dataNew: bzip2 compressed data, block size = 900k
bandit12@bandit:~$ bzip2 -d dataNew
bzip2: Can'</span>t guess original name <span class="k">for </span>dataNew <span class="nt">--</span> using dataNew.out
bandit12@bandit:~<span class="nv">$ </span>file dataNew.out 
dataNew.out: <span class="nb">gzip </span>compressed data, was <span class="s2">"data4.bin"</span>, from Unix, last modified: Thu Sep 28 14:04:06 2017, max compression
bandit12@bandit:~<span class="nv">$ </span>zcat dataNew.out <span class="o">&gt;</span> dataNewer
bandit12@bandit:~<span class="nv">$ </span>file dataNewer
dataNewer: POSIX <span class="nb">tar </span>archive <span class="o">(</span>GNU<span class="o">)</span>
bandit12@bandit:~<span class="nv">$ </span><span class="nb">tar</span> <span class="nt">-xvf</span> dataNewer
data5.bin
bandit12@bandit:~<span class="nv">$ </span><span class="nb">tar</span> <span class="nt">-xvf</span> data5.bin
data6.bin
bandit12@bandit:~<span class="nv">$ </span>file data6.bin
data6.bin: bzip2 compressed data, block size <span class="o">=</span> 900k
bandit12@bandit:~<span class="nv">$ </span>bzip2 <span class="nt">-d</span> data6.bin 
bzip2: Can<span class="s1">'t guess original name for data6.bin -- using data6.bin.out
bandit12@bandit:~$ file data6.bin.out 
data6.bin.out: POSIX tar archive (GNU)
bandit12@bandit:~$ tar -xvf data6.bin.out
data8.bin
bandit12@bandit:~$ file data8.bin 
data8.bin: gzip compressed data, was "data9.bin", from Unix, last modified: Thu Sep 28 14:04:06 2017, max compression
bandit12@bandit:~$ zcat data8.bin &gt; dataNew3  
bandit12@bandit:~$ file dataNew3
dataNew3: ASCII text
bandit12@bandit:~$ cat dataNew3
The password is xxxxxxxxxxxxxxxxxxxxxxxx</span></code></pre></figure>

<h3 id="level-13---level-14">Level 13 -&gt; Level 14</h3>
<p>This level instroduces us to ssh with keys.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">bandit13@bandit:~<span class="nv">$ </span><span class="nb">ls
</span>sshkey.private</code></pre></figure>

<p>We see that the private key is within the current directory. It’s pretty simple from here.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">bandit13@bandit:~<span class="nv">$ </span>ssh <span class="nt">-i</span> sshkey.private bandit14@bandit.labs.overthewire.org <span class="nt">-p</span> 2220
The authenticity of host <span class="s1">'[bandit.labs.overthewire.org]:2220 ([0.0.0.0]:2220)'</span> can<span class="s1">'t be established.
ECDSA key fingerprint is ee:4c:8c:e7:57:2c:bc:63:24:b8:e6:23:27:63:72:9f.
Are you sure you want to continue connecting (yes/no)? yes

...

bandit14@bandit:~$ </span></code></pre></figure>

<p>The manual says that the -i command specifies the file from which the private key for public key authenication is read.</p>

<h3 id="level-14---level-15">Level 14 -&gt; Level 15</h3>
<p>Had a little bit of trouble finding the password for this level, but remembering previous levels, the password was found as follows</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">bandit14@bandit:/<span class="nv">$ </span><span class="nb">cat </span>etc/bandit_pass/bandit14  </code></pre></figure>

<p>We then telnet to the specified port and server</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">bandit14@bandit:/<span class="nv">$ </span>telnet localhost 30000
Trying 127.0.0.1...
Connected to localhost.
Escape character is <span class="s1">'^]'</span><span class="nb">.</span>
xxxxxxxxxxxxxxxxxxxxxxxxxxxx
Correct!

Connection closed by foreign host.
bandit14@bandit:/<span class="nv">$ </span></code></pre></figure>

<h3 id="level-15---level-16">Level 15 -&gt; Level 16</h3>
<p>The answer is basically spelled out for us, just have to read the openssl manual</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">bandit15@bandit:~<span class="nv">$ </span><span class="nb">cat</span> /etc/bandit_pass/bandit15
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
bandit15@bandit:~<span class="nv">$ </span>openssl s_client <span class="nt">-connect</span> localhost:30001 <span class="nt">-ign_eof</span>
CONNECTED<span class="o">(</span>00000003<span class="o">)</span>

...

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Correct!
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</code></pre></figure>

<h3 id="level-16---level-17">Level 16 -&gt; Level 17</h3>
<p>In this level we have to scan ports which match the credentials</p>
<ul>
  <li>Port is in the range 31000 to 32000</li>
  <li>There’s a server listening</li>
  <li>This server speaks SSL
According to the details only one server matches these credentials</li>
</ul>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">bandit16@bandit:~<span class="nv">$ </span><span class="nb">cat</span> /etc/bandit_pass/bandit16
xxxxxxxxxxxxxxxxxxxxxxxxxxxx
bandit16@bandit:~<span class="nv">$ </span>nmap <span class="nt">-p</span> 31000-32000 localhost <span class="nt">-sV</span>

Starting Nmap 6.40 <span class="o">(</span> http://nmap.org <span class="o">)</span> at 2017-10-22 15:42 UTC
Nmap scan report <span class="k">for </span>localhost <span class="o">(</span>127.0.0.1<span class="o">)</span>
Host is up <span class="o">(</span>0.00057s latency<span class="o">)</span><span class="nb">.</span>
Other addresses <span class="k">for </span>localhost <span class="o">(</span>not scanned<span class="o">)</span>: 127.0.0.1
Not shown: 996 closed ports
PORT      STATE SERVICE VERSION
31046/tcp open  <span class="nb">echo
</span>31518/tcp open  msdtc   Microsoft Distributed Transaction Coordinator <span class="o">(</span>error<span class="o">)</span>
31691/tcp open  <span class="nb">echo
</span>31790/tcp open  msdtc   Microsoft Distributed Transaction Coordinator <span class="o">(</span>error<span class="o">)</span>
31960/tcp open  <span class="nb">echo
</span>Service Info: OS: Windows<span class="p">;</span> CPE: cpe:/o:microsoft:windows

Service detection performed. Please report any incorrect results at http://nmap.org/submit/ <span class="nb">.</span>
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>41.48 seconds
bandit16@bandit:~<span class="nv">$ </span>openssl s_client <span class="nt">-connect</span> localhost:31790 <span class="nt">-ign_eof</span> 
CONNECTED<span class="o">(</span>00000003<span class="o">)</span>
<span class="nv">depth</span><span class="o">=</span>0 CN <span class="o">=</span> 8f75dc271013
verify error:num<span class="o">=</span>18:self signed certificate
verify <span class="k">return</span>:1
<span class="nv">depth</span><span class="o">=</span>0 CN <span class="o">=</span> 8f75dc271013
verify <span class="k">return</span>:1
<span class="nt">---</span>
Certificate chain
 0 s:/CN<span class="o">=</span>8f75dc271013
   i:/CN<span class="o">=</span>8f75dc271013
<span class="nt">---</span>
Server certificate
<span class="nt">-----BEGIN</span> CERTIFICATE-----
MIICvjCCAaagAwIBAgIJALADbwWQ0u9aMA0GCSqGSIb3DQEBCwUAMBcxFTATBgNV
BAMTDDhmNzVkYzI3MTAxMzAeFw0xNzA5MTYwNzAyMjRaFw0yNzA5MTQwNzAyMjRa
MBcxFTATBgNVBAMTDDhmNzVkYzI3MTAxMzCCASIwDQYJKoZIhvcNAQEBBQADggEP
ADCCAQoCggEBALmjBUTlmjROJUssm+rAlFADFfzrz+xCH0qUXryou5/wW8pnQ6nG
HbdeRIBwTVGFiDIKRbFdWQU4BbrfjEhyGn9d7eh/3GV09ZdvLDYRoLmJ4tDF8CiC
wGl9GufcWr3zeaNYa8CwVdtWam8umhMICrsv7B5iV9RdSQfudUtVbr26SBVyuhBm
m0t7Su6rLCrrGtshdIihjk4k67bBMpSNAOduhpp79UgIPKcwJUhRJHTcji3m/IQ8
O9zNS25oL8KhMn7e/Xe70kztstq0ShMsx8feutONnGulUOlaEMMqW+HSWgnVeG/r
mU9Nzwn++4qxe16OvvmXAzctH2RlDx7XbcsCAwEAAaMNMAswCQYDVR0TBAIwADAN
BgkqhkiG9w0BAQsFAAOCAQEADHODX5CcMLI5fdumzly5FAVg5Yc22eDGNhmyhi/N
kDhP6QYw+HW5nWEYapc9m/ZQGEEoxr+wj6qeEhscxRxpuEIcunZsLKcoAmToyXeO
ANMslQugRcGqN57Pt0h5VuctLMa3ickeVPFvV6gxJSHBNRK1iN8nrfsy+zR+stzI
xcjIuakDDxMKFtb/1TMKf4/EsimSQLS0WXLjbxfQ/J510O4/Of0tmZI0ZIG+cKmM
V5hAOtuuAk6jREfWYJQ3DB+phv7PO9s2FpofVJss5PK4NWDS7UQOv359ZOJ85ZpJ
ihGxDqV7IAHJZNM9lvFXz/+EOn1oTGW9V8bAwt34OVYoPw<span class="o">==</span>
<span class="nt">-----END</span> CERTIFICATE-----
<span class="nv">subject</span><span class="o">=</span>/CN<span class="o">=</span>8f75dc271013
<span class="nv">issuer</span><span class="o">=</span>/CN<span class="o">=</span>8f75dc271013
<span class="nt">---</span>
No client certificate CA names sent
<span class="nt">---</span>
SSL handshake has <span class="nb">read </span>1682 bytes and written 637 bytes
<span class="nt">---</span>
New, TLSv1/SSLv3, Cipher is DHE-RSA-AES256-SHA
Server public key is 2048 bit
Secure Renegotiation IS supported
Compression: NONE
Expansion: NONE
SSL-Session:
    Protocol  : SSLv3
    Cipher    : DHE-RSA-AES256-SHA
    Session-ID: B8FE8CF276F42F7F3B5C4CA141163834B59545DFC0347C29B8DC734FC80905CF
    Session-ID-ctx: 
    Master-Key: F60DB3D5FFADCDFEA5AF728C18D9276F467143557D4BC6DF9C3C39685F17AD2C14EFD1BEA0C8FBB7B89912A95D46C7CC
    Key-Arg   : None
    PSK identity: None
    PSK identity hint: None
    SRP username: None
    Start Time: 1508687222
    Timeout   : 300 <span class="o">(</span>sec<span class="o">)</span>
    Verify <span class="k">return </span>code: 18 <span class="o">(</span>self signed certificate<span class="o">)</span>
<span class="nt">---</span>
xxxxxxxxxxxxxxxxxxxxxxxxxxxx
Correct!
<span class="nt">-----BEGIN</span> RSA PRIVATE KEY-----
MIIEogIBAAKCAQEAvmOkuifmMg6HL2YPIOjon6iWfbp7c3jx34YkYWqUH57SUdyJ
imZzeyGC0gtZPGujUSxiJSWI/oTqexh+cAMTSMlOJf7+BrJObArnxd9Y7YT2bRPQ
Ja6Lzb558YW3FZl87ORiO+rW4LCDCNd2lUvLE/GL2GWyuKN0K5iCd5TbtJzEkQTu
DSt2mcNn4rhAL+JFr56o4T6z8WWAW18BR6yGrMq7Q/kALHYW3OekePQAzL0VUYbW
JGTi65CxbCnzc/w4+mqQyvmzpWtMAzJTzAzQxNbkR2MBGySxDLrjg0LWN6sK7wNX
x0YVztz/zbIkPjfkU1jHS+9EbVNj+D1XFOJuaQIDAQABAoIBABagpxpM1aoLWfvD
KHcj10nqcoBc4oE11aFYQwik7xfW+24pRNuDE6SFthOar69jp5RlLwD1NhPx3iBl
J9nOM8OJ0VToum43UOS8YxF8WwhXriYGnc1sskbwpXOUDc9uX4+UESzH22P29ovd
d8WErY0gPxun8pbJLmxkAtWNhpMvfe0050vk9TL5wqbu9AlbssgTcCXkMQnPw9nC
YNN6DDP2lbcBrvgT9YCNL6C+ZKufD52yOQ9qOkwFTEQpjtF4uNtJom+asvlpmS8A
vLY9r60wYSvmZhNqBUrj7lyCtXMIu1kkd4w7F77k+DjHoAXyxcUp1DGL51sOmama
+TOWWgECgYEA8JtPxP0GRJ+IQkX262jM3dEIkza8ky5moIwUqYdsx0NxHgRRhORT
8c8hAuRBb2G82so8vUHk/fur85OEfc9TncnCY2crpoqsghifKLxrLgtT+qDpfZnx
SatLdt8GfQ85yA7hnWWJ2MxF3NaeSDm75Lsm+tBbAiyc9P2jGRNtMSkCgYEAypHd
HCctNi/FwjulhttFx/rHYKhLidZDFYeiE/v45bN4yFm8x7R/b0iE7KaszX+Exdvt
SghaTdcG0Knyw1bpJVyusavPzpaJMjdJ6tcFhVAbAjm7enCIvGCSx+X3l5SiWg0A
R57hJglezIiVjv3aGwHwvlZvtszK6zV6oXFAu0ECgYAbjo46T4hyP5tJi93V5HDi
Ttiek7xRVxUl+iU7rWkGAXFpMLFteQEsRr7PJ/lemmEY5eTDAFMLy9FL2m9oQWCg
R8VdwSk8r9FGLS+9aKcV5PI/WEKlwgXinB3OhYimtiG2Cg5JCqIZFHxD6MjEGOiu
L8ktHMPvodBwNsSBULpG0QKBgBAplTfC1HOnWiMGOU3KPwYWt0O6CdTkmJOmL8Ni
blh9elyZ9FsGxsgtRBXRsqXuz7wtsQAgLHxbdLq/ZJQ7YfzOKU4ZxEnabvXnvWkU
YOdjHdSOoKvDQNWu6ucyLRAWFuISeXw9a/9p7ftpxm0TSgyvmfLF2MIAEwyzRqaM
77pBAoGAMmjmIJdjp+Ez8duyn3ieo36yrttF5NSsJLAbxFpdlc1gvtGCWW+9Cq0b
dxviW8+TFVEBl1O4f7HVm6EpTscdDxU+bCXWkfjuRb7Dy9GOtt9JPsX8MBTakzh3
vBgsyi/sN3RqRBcGU40fOoZyfAMT8s1m/uYv52O6IgeuZ/ujbjY<span class="o">=</span>
<span class="nt">-----END</span> RSA PRIVATE KEY-----

<span class="nb">read</span>:errno<span class="o">=</span>0</code></pre></figure>

<p>We obtained an RSA key, so we’re going to have to use ssh to connect to next level</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">bandit16@bandit:~<span class="nv">$ </span>vim sshprivate.private 
bandit16@bandit:~<span class="nv">$ </span><span class="nb">chmod </span>600 sshprivate.private 
bandit16@bandit:~<span class="nv">$ </span>ssh <span class="nt">-i</span> sshprivate.private bandit17@localhost</code></pre></figure>

<h3 id="level-17---level-18">Level 17 -&gt; Level 18</h3>
<p>The power of the diff command</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">bandit17@bandit:~<span class="nv">$ </span>diff passwords.new passwords.old   
42c42
&lt; xxxxxxxxxxxxx
<span class="nt">---</span>
<span class="o">&gt;</span> xxxxxxxxxxxxxx
bandit17@bandit:~<span class="nv">$ </span></code></pre></figure>

<h3 id="level-18---level-19">Level 18 -&gt; Level 19</h3>
<p>When we try to ssh we get logged out immediately</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">bandit17@bandit:~<span class="nv">$ </span>ssh bandit18@localhost           

...

Byebye <span class="o">!</span>
Connection to localhost closed.
bandit17@bandit:~<span class="nv">$ </span>ssh bandit18@localhost <span class="nb">cat </span>readme

...

bandit18@localhost<span class="s1">'s password: 
xxxxxxxxxxxxxxxx</span></code></pre></figure>

<h3 id="level-19---level-20">Level 19 -&gt; Level 20</h3>
<p>We get a SUID binary. Running it gives us some useful information</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">bandit19@bandit:~<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-l</span>
total 8
<span class="nt">-rwsr-x---</span> 1 bandit20 bandit19 7378 Sep 28 14:04 bandit20-do
bandit19@bandit:~<span class="nv">$ </span>./bandit20-do 
Run a <span class="nb">command </span>as another user.
  Example: ./bandit20-do <span class="nb">id
</span>bandit19@bandit:~<span class="nv">$ </span>./bandit20-do <span class="nb">cat</span> /etc//bandit_pass/bandit20 </code></pre></figure>

<h3 id="level-20---level-21">Level 20 -&gt; Level 21</h3>
<p>I opened two shells. In the first shell I type. Due to changes, port forwarding need to be implemented</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">NashMacbook:~ nashe<span class="nv">$ </span>ssh <span class="nt">-l</span> bandit20 <span class="nt">-p</span> 2220 <span class="nt">-L</span> 1234:localhost:22 bandit.labs.overthewire.org</code></pre></figure>

<p>On the second I type</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">NashMacbook:~ nashe<span class="nv">$ </span>ssh localhost <span class="nt">-p</span> 1234</code></pre></figure>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">bandit20@bandit:~<span class="nv">$ </span>nc <span class="nt">-l</span> 55555</code></pre></figure>

<p>In the second shell I type</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">bandit20@bandit:~<span class="nv">$ </span><span class="nb">ls
</span>suconnect
bandit20@bandit:~<span class="nv">$ </span>./suconnect 55555</code></pre></figure>

<p>Answer outputs to first shell</p>

<h3 id="level-21---level-22">Level 21 -&gt; Level 22</h3>
<p>We can check the cron directory and gain some info from that</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">bandit21@bandit:~<span class="nv">$ </span><span class="nb">cd</span> /etc/cron.d
bandit21@bandit:/etc/cron.d<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-la</span>
total 32
drwxr-xr-x   2 root root 4096 Sep 28 14:04 <span class="nb">.</span>
drwxr-xr-x 119 root root 4096 Oct 22 18:57 ..
<span class="nt">-rw-r--r--</span>   1 root root  102 Feb  9  2013 .placeholder
<span class="nt">-rw-r--r--</span>   1 root root  355 May 25  2013 cron-apt
<span class="nt">-rw-r--r--</span>   1 root root  120 Sep 28 14:04 cronjob_bandit22
<span class="nt">-rw-r--r--</span>   1 root root  122 Sep 28 14:04 cronjob_bandit23
<span class="nt">-rw-r--r--</span>   1 root root  120 Sep 28 14:04 cronjob_bandit24
<span class="nt">-rw-r--r--</span>   1 root root  510 Aug  4 20:03 php5 
bandit21@bandit:/etc/cron.d<span class="nv">$ </span><span class="nb">cat </span>cronjob_bandit22
@reboot bandit22 /usr/bin/cronjob_bandit22.sh &amp;&gt; /dev/null
<span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> bandit22 /usr/bin/cronjob_bandit22.sh &amp;&gt; /dev/null 
bandit21@bandit:/etc/cron.d<span class="nv">$ </span><span class="nb">cat</span> /usr/bin/cronjob_bandit22.sh
<span class="c">#!/bin/bash</span>
<span class="nb">chmod </span>644 /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv
<span class="nb">cat</span> /etc/bandit_pass/bandit22 <span class="o">&gt;</span> /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv
bandit21@bandit:/etc/cron.d<span class="nv">$ </span><span class="nb">cat</span> /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv</code></pre></figure>

<h3 id="level-22---level-23">Level 22 -&gt; Level 23</h3>
<p>Similar to the last level, we have to take a look at the cron jobs</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">bandit22@bandit:~<span class="nv">$ </span><span class="nb">cd</span> /etc/cron.d
bandit22@bandit:/etc/cron.d<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-la</span>
total 32
drwxr-xr-x   2 root root 4096 Sep 28 14:04 <span class="nb">.</span>
drwxr-xr-x 119 root root 4096 Oct 22 18:57 ..
<span class="nt">-rw-r--r--</span>   1 root root  102 Feb  9  2013 .placeholder
<span class="nt">-rw-r--r--</span>   1 root root  355 May 25  2013 cron-apt
<span class="nt">-rw-r--r--</span>   1 root root  120 Sep 28 14:04 cronjob_bandit22
<span class="nt">-rw-r--r--</span>   1 root root  122 Sep 28 14:04 cronjob_bandit23
<span class="nt">-rw-r--r--</span>   1 root root  120 Sep 28 14:04 cronjob_bandit24
<span class="nt">-rw-r--r--</span>   1 root root  510 Aug  4 20:03 php5
bandit22@bandit:/etc/cron.d<span class="nv">$ </span><span class="nb">cat </span>cronjob_bandit23
@reboot bandit23 /usr/bin/cronjob_bandit23.sh  &amp;&gt; /dev/null
<span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> bandit23 /usr/bin/cronjob_bandit23.sh  &amp;&gt; /dev/null
bandit22@bandit:/etc/cron.d<span class="nv">$ </span><span class="nb">cat</span> /usr/bin/cronjob_bandit23.sh
<span class="c">#!/bin/bash</span>

<span class="nv">myname</span><span class="o">=</span><span class="k">$(</span><span class="nb">whoami</span><span class="k">)</span>
<span class="nv">mytarget</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo </span>I am user <span class="nv">$myname</span> | <span class="nb">md5sum</span> | <span class="nb">cut</span> <span class="nt">-d</span> <span class="s1">' '</span> <span class="nt">-f</span> 1<span class="k">)</span>

<span class="nb">echo</span> <span class="s2">"Copying passwordfile /etc/bandit_pass/</span><span class="nv">$myname</span><span class="s2"> to /tmp/</span><span class="nv">$mytarget</span><span class="s2">"</span>

<span class="nb">cat</span> /etc/bandit_pass/<span class="nv">$myname</span> <span class="o">&gt;</span> /tmp/<span class="nv">$mytarget</span>
bandit22@bandit:/etc/cron.d<span class="nv">$ </span>/usr/bin/cronjob_bandit23.sh
Copying passwordfile /etc/bandit_pass/bandit22 to /tmp/8169b67bd894ddbb4412f91573b38db3
bandit22@bandit:/etc/cron.d<span class="nv">$ </span><span class="nb">cat</span> /tmp/8169b67bd894ddbb4412f91573b38db3
x</code></pre></figure>

<p>This isn’t the answer, I misread the shell script, it actually outputs the password to bandit22 to that file.
The whoami set’s to bandit22 when we call the script.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">bandit22@bandit:/etc/cron.d<span class="nv">$ </span><span class="nb">echo </span>I am user bandit23 | <span class="nb">md5sum</span> | <span class="nb">cut</span> <span class="nt">-d</span> <span class="s1">''</span> <span class="nt">-f</span> 1
8ca319486bfbbc3663ea0fbe81326349  -
bandit22@bandit:/etc/cron.d<span class="nv">$ </span><span class="nb">cat</span> /tmp/8ca319486bfbbc3663ea0fbe81326349
x</code></pre></figure>

<p>That’s a bingo!</p>

<h3 id="level-23---level-24">Level 23 -&gt; Level 24</h3>
<p>We get to write our first shell script which is cool!</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">bandit23@bandit:~<span class="nv">$ </span><span class="nb">cd</span> /etc/cron.d
bandit23@bandit:/etc/cron.d<span class="nv">$ </span><span class="nb">ls
</span>cron-apt  cronjob_bandit22  cronjob_bandit23  cronjob_bandit24  php5
bandit23@bandit:/etc/cron.d<span class="nv">$ </span><span class="nb">cat </span>cronjob_bandit24
@reboot bandit24 /usr/bin/cronjob_bandit24.sh &amp;&gt; /dev/null
<span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> bandit24 /usr/bin/cronjob_bandit24.sh &amp;&gt; /dev/null
bandit23@bandit:/etc/cron.d<span class="nv">$ </span><span class="nb">cat</span> /usr/bin/cronjob_bandit24.sh
<span class="c">#!/bin/bash</span>

<span class="nv">myname</span><span class="o">=</span><span class="k">$(</span><span class="nb">whoami</span><span class="k">)</span>

<span class="nb">cd</span> /var/spool/<span class="nv">$myname</span>
<span class="nb">echo</span> <span class="s2">"Executing and deleting all scripts in /var/spool/</span><span class="nv">$myname</span><span class="s2">:"</span>
<span class="k">for </span>i <span class="k">in</span> <span class="k">*</span> .<span class="k">*</span><span class="p">;</span>
<span class="k">do
    if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$i</span><span class="s2">"</span> <span class="o">!=</span> <span class="s2">"."</span> <span class="nt">-a</span> <span class="s2">"</span><span class="nv">$i</span><span class="s2">"</span> <span class="o">!=</span> <span class="s2">".."</span> <span class="o">]</span><span class="p">;</span>
    <span class="k">then
	</span><span class="nb">echo</span> <span class="s2">"Handling </span><span class="nv">$i</span><span class="s2">"</span>
	<span class="nb">timeout</span> <span class="nt">-s</span> 9 60 ./<span class="nv">$i</span>
	<span class="nb">rm</span> <span class="nt">-f</span> ./<span class="nv">$i</span>
    <span class="k">fi
done</span></code></pre></figure>

<p>Let’s edit run the script</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">bandit23@bandit:/var/spool/bandit24<span class="nv">$ </span>/usr/bin/cronjob_bandit24.sh 
/usr/bin/cronjob_bandit24.sh: line 5: <span class="nb">cd</span>: /var/spool/bandit23: No such file or directory

...

bandit23@bandit:~<span class="nv">$ </span>vim script.sh
bandit23@bandit:~<span class="nv">$ </span><span class="nb">cat </span>script.sh 
<span class="c">#!/bin/bash</span>
<span class="nv">myname</span><span class="o">=</span><span class="k">$(</span><span class="nb">whoami</span><span class="k">)</span>

<span class="nb">cat</span> /etc/bandit_pass/myname <span class="o">&gt;</span> /tmp/myname
bandit23@bandit:~<span class="nv">$ </span><span class="nb">chmod</span> <span class="nt">-R</span> 777 /tmp/bandit24
bandit23@bandit:~<span class="nv">$ </span>vim script.sh
bandit23@bandit:~<span class="nv">$ </span><span class="nb">chmod </span>777 script.sh 
bandit23@bandit:~<span class="nv">$ </span><span class="nb">cp </span>script.sh /var/spool/bandit24/
bandit23@bandit:~<span class="nv">$ </span><span class="nb">cat</span> /tmp/bandit24
x</code></pre></figure>

<p>At this point we get should get the password but the level appears to be broken</p>

<h3 id="level-24---level-25">Level 24 -&gt; Level 25</h3>
<p>I decided to write a python script to obtain the answer</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">socket</span> 

<span class="n">pin</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">password</span> <span class="o">=</span> <span class="s">'UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ'</span>

<span class="n">clientSocket</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">()</span> <span class="c1"># Default AF_INet and SOCK_STREAMM
</span><span class="n">clientSocket</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="s">'localhost'</span><span class="p">,</span> <span class="mi">30002</span><span class="p">))</span>
<span class="n">clientSocket</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="k">while</span> <span class="n">pin</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10000</span><span class="p">):</span>
	<span class="n">m</span> <span class="o">=</span> <span class="n">password</span> <span class="o">+</span> <span class="s">' '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pin</span><span class="p">)</span> <span class="o">+</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span>
	<span class="k">print</span> <span class="n">m</span> 
	<span class="n">clientSocket</span><span class="o">.</span><span class="n">sendall</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
	<span class="n">data</span> <span class="o">=</span> <span class="n">clientSocket</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
	<span class="k">print</span> <span class="n">data</span>
	<span class="n">pin</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="c1"># Connection will drop when right answer found</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">...

Wrong! Please enter the correct pincode. Try again.

UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 5583

Wrong! Please enter the correct pincode. Try again.

UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 5584

Wrong! Please enter the correct pincode. Try again.

UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 5585

Wrong! Please enter the correct pincode. Try again.

UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 5586

Wrong! Please enter the correct pincode. Try again.

UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 5587

Wrong! Please enter the correct pincode. Try again.

UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 5588

Correct!
The password of user bandit25 is xxxxxxxxxxxxxxxxxxxxx
Exiting.

UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 5589


UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 5590

Traceback <span class="o">(</span>most recent call last<span class="o">)</span>:
  File <span class="s2">"brute.py"</span>, line 12, <span class="k">in</span> &lt;module&gt;
    clientSocket.sendall<span class="o">(</span>m<span class="o">)</span>
  File <span class="s2">"/usr/lib/python2.7/socket.py"</span>, line 224, <span class="k">in </span>meth
    <span class="k">return </span>getattr<span class="o">(</span>self._sock,name<span class="o">)(</span><span class="k">*</span>args<span class="o">)</span>
socket.error: <span class="o">[</span>Errno 32] Broken pipe</code></pre></figure>

<h3 id="level-25---level-26-and-level-26---level-27">Level 25 -&gt; Level 26 and Level 26 -&gt; Level 27</h3>
<p>Lets first find the password, which apparently should be easy</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">bandit25@bandit:~<span class="nv">$ </span><span class="nb">ls
</span>bandit26.sshkey
bandit25@bandit:~<span class="nv">$ </span>ssh <span class="nt">-i</span> bandit26.sshkey bandit26@localhost

...

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.

  _                     _ _ _   ___   __  
 | |                   | <span class="o">(</span>_<span class="o">)</span> | |__ <span class="se">\ </span>/ /  
 | |__   __ _ _ __   __| |_| |_   <span class="o">)</span> / /_  
 | <span class="s1">'_ \ / _` | '</span>_ <span class="se">\ </span>/ _<span class="sb">`</span> | | __| / / <span class="s1">'_ \ 
 | |_) | (_| | | | | (_| | | |_ / /| (_) |
 |_.__/ \__,_|_| |_|\__,_|_|\__|____\___/ 
Connection to localhost closed.</span></code></pre></figure>

<p>This part is actually pretty cool</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">bandit25@bandit:~<span class="nv">$ </span><span class="nb">cat</span> /etc/passwd | <span class="nb">grep </span>bandit26
bandit26:x:11026:11026:bandit level 26:/home/bandit26:/usr/bin/showtext
bandit25@bandit:~<span class="nv">$ </span><span class="nb">cat</span> /usr/bin/showtext
<span class="c">#!/bin/sh</span>

<span class="nb">export </span><span class="nv">TERM</span><span class="o">=</span>linux

more ~/text.txt
<span class="nb">exit </span>0</code></pre></figure>

<p>Now if we reduce terminal size to only allow 5 lines, we can ssh into bandit26, type vim and then type :r /etc/bandit_pass/bandit26 and vim will give us the password.</p>

<h3 id="conclusion">Conclusion</h3>

<p>This whole wargame was really fun, it tested my abilities and I learnt a bunch of linux commands in the process.</p>

<p>~Nashe</p>
